name: SSH to Localhost

on:
  workflow_dispatch:  # Manual trigger

jobs:
  ssh-local:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Setup SSH key
        run: |
          mkdir -p ~/.ssh
          # Generate a temporary key for localhost testing
          ssh-keygen -t rsa -b 2048 -f ~/.ssh/id_rsa -N "" -q
          cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
          chmod 600 ~/.ssh/id_rsa
          chmod 600 ~/.ssh/authorized_keys
          ssh-keyscan -H localhost >> ~/.ssh/known_hosts

      - name: Test SSH connection to localhost
        run: |
          ssh -o StrictHostKeyChecking=no runner@localhost "echo 'âœ… SSH connection successful!'"
